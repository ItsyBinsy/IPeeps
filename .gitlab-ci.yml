image: python:3.10

stages:
  - test

variables:
  # Local cache directory for pip between jobs
  PIP_CACHE_DIR: "$CI_PROJECT_DIR/.cache/pip"
  # Default API key for CI so imports that require it won't fail.
  # Override this in GitLab project/group CI variables for real runs.
  ABSTRACT_API_KEY: "test_ci_api_key"

cache:
  paths:
    - .cache/pip

before_script:
  - python -m pip install --upgrade pip
  - pip install -r requirements.txt

test:
  stage: test
  script:
    - pytest -q
  only:
    - branches
    - merge_requests
